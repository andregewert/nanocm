<?php
/* @var $this Ubergeek\NanoCm\Module\CoreModule */
$medium = null;
$format = null;
$class = ($this->article->articleType instanceof \Ubergeek\NanoCm\Definition)? $this->article->articleType->value : '';

if (!empty($this->article->medium_id)) {
    if (($format = $this->orm->getImageFormatByKey('banner')) !== null) {
        $medium = $this->orm->getMediumById($this->article->medium_id);
    }
}
?>

<div class="container spacing <?php echo $class; ?>">
    <h1><?php echo $this->htmlEncode($this->article->headline); ?></h1>

    <?php if ($format != null && $medium != null) : ?>
        <img src="<?php echo $this->htmlEncode($medium->getImageUrl($format->key)); ?>"
             class="<?php echo $this->htmlEncode($format->key); ?>"
             title="<?php echo $this->htmlEncode($medium->title); ?>"
            <?php if ($format->width > 0) echo "width=\"$format->width\""; ?>
            <?php if ($format->height > 0) echo "height=\"$format->height\""; ?>>
    <?php endif; ?>

    <?php echo $this->ncm->convertFormattedText($this->article->content); ?>

    <div class="articlefooter">
        Ver&ouml;ffentlicht von
        <?php echo $this->htmlEncode($this->orm->convertUserIdToName($this->article->author_id, false)); ?>
        am
        <?php echo $this->htmlEncode($this->article->publishing_timestamp->format('d.m.Y')); ?>
        &bullet;
        <a href="<?php echo $this->htmlEncode($this->article->getArticleUrl()); ?>#comments">Kommentieren</a>
        &bullet;
        <a href="<?php echo $this->htmlEncode(
            \Ubergeek\NanoCm\Util::getTweetThisUrl(
                $this->frontController->createAbsoluteSiteLink(
                    $this->article->getArticleUrl()
                ),
                $this->article->headline
            )
        ); ?>" target="_blank">Twittern</a>
    </div>
</div>
